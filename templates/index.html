<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Counting Sunday Streets</title>
  <!-- Bootstrap core CSS -->
  <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename='starter-template.css') }}" rel="stylesheet">


  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
    </head>

    <body>

      <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Counting Sunday Streets</a>
          </div>
          <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
              <li class="active"><a href="#">Home</a></li>
            <!-- <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li> -->
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    </br> </br>

    <input class="btn btn-default" type="button" value="Start" id="startButton" />
    
    </br></br>
    <span id="time"></span>
    </br></br>
    <p> <span id="displayCountPed">0</span> Pedestrians | <span id="displayCountBike">0</span> Cyclists </p>

</br></br>
<form id="counter" method="post" action=" {{ url_for('hello') }} ">
  <div class="form-group">
    <input class="btn btn-default" type="button" value="Count Pedestrian" id="countPedButton" />
    <input class="btn btn-default" type="button" value="Count Bike" id="countBikeButton" />
    <input type="hidden" id="buttonPedValue" name="buttonPedValue" >
    <input type="hidden" id="buttonBikeValue" name="buttonBikeValue" >
  </div>
</form>

</div><!-- /.container -->

    <script type="text/javascript">
      var countPed = 0;
      var countBike = 0;
      var pedButton = document.getElementById("countPedButton");
      var bikeButton = document.getElementById("countBikeButton");
      var start = document.getElementById("startButton");
      var displayNumPed = document.getElementById("displayCountPed");   
      var displayNumBike = document.getElementById("displayCountBike");
      var buttonPedValue = document.getElementById("buttonPedValue")
      var buttonBikeValue = document.getElementById("buttonBikeValue")

      start.onclick = function(){
        display = document.querySelector('#time');
        startTimer(5, display);
      }

      pedButton.onclick = function(){
        countPed++;
        displayNumPed.innerHTML = countPed;
      }

      bikeButton.onclick = function(){
        countBike++;
        displayNumBike.innerHTML = countBike;
      }

      function startTimer(duration, display) {
        var start = Date.now(),
        diff,
        minutes,
        seconds;
        function timer() {
        // get the number of seconds that have elapsed since 
        // startTimer() was called
        diff = duration - (((Date.now() - start) / 1000) | 0);

        // does the same job as parseInt truncates the float
        minutes = (diff / 60) | 0;
        seconds = (diff % 60) | 0;

        minutes = minutes < 10 ? "0" + minutes : minutes;
        seconds = seconds < 10 ? "0" + seconds : seconds;

        display.textContent = minutes + ":" + seconds; 

        if (diff <= 0) {
            // add one second so that the count down starts at the full duration
            // example 05:00 not 04:59
            start = Date.now() + 1000;
          }
        if (diff == 0) {
          buttonPedValue.value = countPed;
          buttonBikeValue.value = countBike;
          document.getElementById("counter").submit();
        }

        };
    // we don't want to wait a full second before the timer starts
    timer();
    setInterval(timer, 1000);
  }

  //window.onload = function () {
    //var fiveMinutes = 60 * 15,
    //display = document.querySelector('#time');
    //startTimer(10, display);
  //};
</script>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
  </body>
  </html>
